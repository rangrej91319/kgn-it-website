from zipfile import ZipFile
import os

# Create paths
gallery_html = """
<section id="gallery">
  <h2>Our Products</h2>
  <div class="gallery">
    <div><img src="images/monitor.jpg" alt="Monitor"><p>Monitor</p></div>
    <div><img src="images/cabinet.jpg" alt="Cabinet"><p>Cabinet</p></div>
    <div><img src="images/motherboard.jpg" alt="Motherboard"><p>Motherboard</p></div>
    <div><img src="images/ssd.jpg" alt="SSD"><p>SSD</p></div>
    <div><img src="images/ups.jpg" alt="UPS"><p>UPS</p></div>
    <div><img src="images/cctv.jpg" alt="CCTV"><p>CCTV Camera</p></div>
  </div>
</section>
"""

# Reuse and update the previous HTML content with live background and gallery
html_with_gallery = html_content.replace(
    "</section>\n\n  <section id=\"invoice\">", 
    f"</section>\n\n  {gallery_html}\n  <section id=\"invoice\">"
).replace(
    "<style>",
    """<style>
    body {
      background: linear-gradient(270deg, #e3f2fd, #ffffff, #e3f2fd);
      background-size: 600% 600%;
      animation: backgroundMove 10s ease infinite;
    }
    @keyframes backgroundMove {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      padding: 1rem;
    }
    .gallery div {
      background: white;
      padding: 0.5rem;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .gallery img {
      max-width: 100%;
      height: auto;
      border-radius: 6px;
    }"""
)

# Create directory structure
image_folder = f"{base_path}/images"
os.makedirs(image_folder, exist_ok=True)

# Prepare dummy image files (since real image content can't be downloaded here)
dummy_img_path = "/mnt/data/dummy.jpg"
with open(dummy_img_path, "wb") as f:
    f.write(b"\xFF\xD8\xFF\xE0" + b"\x00" * 100)  # Minimal JPEG header with padding

# Copy the dummy image as placeholders
for name in ["monitor", "cabinet", "motherboard", "ssd", "ups", "cctv"]:
    shutil.copy(dummy_img_path, f"{image_folder}/{name}.jpg")

# Update index.html file
with open(index_path, "w") as f:
    f.write(html_with_gallery)

# Create new zip with images included
zip_path_gallery = "/mnt/data/kgn_it_website_with_gallery.zip"
with ZipFile(zip_path_gallery, "w") as zipf:
    zipf.write(index_path, arcname="index.html")
    zipf.write(f"{base_path}/logo.png", arcname="logo.png")
    for img_file in os.listdir(image_folder):
        zipf.write(f"{image_folder}/{img_file}", arcname=f"images/{img_file}")

zip_path_gallery
